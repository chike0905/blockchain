@startuml
skinparam shadowing false
skinparam monochrome true

title Blockchain: Generate New Block

Chain_Manager -> Storage: Get Last Block
activate Chain_Manager
Storage --> Chain_Manager: Last Block
Chain_Manager -> Chain_Manager: Hash Last Block by SHA256
Chain_Manager -> TX_Manager: Get All TXs in TX Pool
TX_Manager -> Chain_Manager: All TXs in TX Pool
Chain_Manager -> Chain_Manager: Generate  New Block
Chain_Manager -> Block_Verifier: Verify New Block
Block_Verifier -> Chain_Manager: Pass/Fail
alt Pass
  Chain_Manager -> Storage: Save New Block
  Chain_Manager -> Message_Manager: Send New Block to all Peer
  loop for all peers
    Message_Manager -> Node: Send New Block
  end
else Fail
  note over Chain_Manager: Do Nothing(Chain is updated\nwhile generating new Blcok)
end
deactivate Chain_Manager
@enduml
